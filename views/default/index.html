<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en">
<head>
    <link rel="shortcut icon" href="{{=URL('static','favicon.ico')}}" type="image/x-icon">

<link rel="stylesheet" type="text/css" href="/{{=request.application}}/static/scripts/ext/resources/css/ext-all.css" />
<link rel="stylesheet" type="text/css" href="/{{=request.application}}/static/scripts/ext/resources/css/yourtheme.css" />
<script type="text/javascript" src="/{{=request.application}}/static/scripts/ext/adapter/ext/ext-base.js"></script>
<script src="/{{=request.application}}/static/scripts/ext/ext-all.js" type="text/javascript"></script>
<script type="text/javascript" src="/{{=request.application}}/static/scripts/OpenLayers/OpenLayers.js"></script>
<script type="text/javascript" src="/{{=request.application}}/static/scripts/GeoExt/lib/GeoExt.js"></script>
<script language="javascript" type="text/javascript" src="/{{=request.application}}/static/scripts/edit_area/edit_area_full.js"></script>
<script type="text/javascript" src="/{{=request.application}}/scripts/base.js"></script>
<script type="text/javascript" src="/{{=request.application}}/static/scripts/utils.js"></script>
<script type="text/javascript" src="/{{=request.application}}/scripts/data.js"></script>
<script type="text/javascript" src="/{{=request.application}}/static/scripts/grid.js"></script>
<script type="text/javascript" src="/{{=request.application}}/static/scripts/tree.js"></script>
<script type="text/javascript" src="/{{=request.application}}/static/scripts/panels/map.js"></script>
<script type="text/javascript" src="/{{=request.application}}/static/scripts/panels/tool.js"></script>
<script type="text/javascript" src="/{{=request.application}}/static/scripts/panels/side.js"></script>
<script type="text/javascript" src="/{{=request.application}}/static/scripts/panels/info.js"></script>
<script type="text/javascript" src="/{{=request.application}}/static/scripts/panels/find.js"></script>

<script type="text/javascript" src="/{{=request.application}}/static/scripts/windows/base.js"></script>
<script type="text/javascript" src="/{{=request.application}}/static/scripts/windows/dev.js"></script>
<script type="text/javascript" src="/{{=request.application}}/static/scripts/windows/result.js"></script>

<script type="text/javascript">
    hs.app = {};
    //window.addEventListener ('load', function () {
    Ext.onReady (function () {
   
    if (!('console' in window)) {
    console = {
        log: function () {},
        err: function () {},
    };
    }

    hs.app.map = mapTab = new hs.map.Panel ({
    title: 'Map',
    region: 'center',
    });

    hs.app.info = new hs.info.Panel ({
    title: 'Info',
    region: 'center',
    layout: 'border',
    });

    hs.app.user = {};

    {{if side_bar:}}

    //var saved_maps = new hs.side.MapPanel ({{response.write (maps_saved, escape = False)}});
    hs.app.user.maps = new hs.side.MapPanel ({{response.write (maps_saved, escape = False)}});
    hs.app.user.maps.linkMap (mapTab);

    hs.app.user.tools = new hs.side.ToolPanel ({{response.write (tool_list, escape = False)}});

    //var saved_results = new hs.side.ResultPanel ({{response.write (tool_saved_results, escape = False)}});
    hs.app.user.results = new hs.side.ResultPanel ({{response.write (tool_saved_results, escape = False)}});

    hs.app.user.analyses = new hs.side.AnalysisPanel ({{response.write (tool_saved_analyses, escape = False)}});
    /*var saved_analyses = new hs.tree.Panel ({{response.write (tool_saved_analyses, escape = False)}}, {
        datatype: 'analyses',
    });*/

    {{ else: }}

    hs.app.user.maps = null;
    hs.app.user.tools = null;
    hs.app.user.results = null;
    hs.app.user.analyses = null;

    {{ pass }}

    {{ if dev_tools: }}
    hs.app.user.dev = new hs.side.DevPanel ({{response.write (in_dev, escape = False)}});
    /*var devtools = new hs.tree.Panel ({{response.write (in_dev, escape = False)}}, {
        datatype: 'dev_tools',
        title: 'Development Tools',
        enableDD: false,
        enableDrop: false,
        enableDrag: true,
        ddGroup: 'tools',
    });*/
    {{ pass }}

    hs.app.find = new hs.find.Panel ({
    title: 'Find',
    });

    /*var wikiPanel = new Ext.Panel ({
    title: 'Blog',
    region: 'center',
    autoLoad: '/{{ =request.application }}/plugin_wiki',
    autoScroll: true,
    });*/

    hs.app.blog = new hs.util.IFramePanel ({

	title: 'Main',
	region: 'center',
	autoScroll: true,
    }, '/{{ =request.application }}/plugin_wiki/index/blog');

    hs.app.case = new hs.util.IFramePanel ({
	title: 'Case Studies',
	region: 'center',
	autoScroll: true,
    }, '/{{ =request.application }}/plugin_wiki/index/case');

    hs.app.docs = new hs.util.IFramePanel ({
	title: 'Documentation',
	region: 'center',
	autoScroll: true,
    }, '/{{ =request.application }}/plugin_wiki/index/docs');

    hs.app.tutorials = new hs.util.IFramePanel ({
	title: 'Tutorials',
	region: 'center',
	autoScroll: true,
    }, '/{{ =request.application }}/plugin_wiki/index/tutorials');


    hs.side = new Ext.Panel ({
        title: 'Controls',
    autoScroll: true,
    //collapsible: true,
    width: 250,
    region: 'west',
        items: [
        {{ if not side_bar: }}{
        xtype: 'panel',

        html: '<div style="text-align: center;"><!--<a href="{{=URL (a=request.application, c='default', f='user', args=['register'])}}">Register</a> or--><a href="{{=URL (scheme='https', a=request.application, c='default', f='user', args=['login'])}}">Login</a> with Gmail to activate your sidebar</div>',

        border: false,
        padding: 10,
            },{{else:}}
        {
        xtype: 'panel',
        html: '<div><a href="{{=URL (a=request.application, c='default', f='user', args=['logout'])}}">Logout</a></div>',
        border: false,
        padding: 10,
            },
            {{pass}}
            {{ if side_bar: }}hs.app.user.maps,
            {{ if dev_tools: }}hs.app.user.dev,{{pass}}
            hs.app.user.tools,
            hs.app.user.results,
            hs.app.user.analyses,{{pass}}
        ],
    });

    hs.app.tool = new hs.tool.Panel (hs.app.user.results, hs.app.user.analyses);

    /*var mapTab = new Ext.Panel ({
    title: 'Map',
    region: 'center',
    });*/

    hs.app.splash = new hs.util.IFramePanel ({
    title: 'Main',
    }, '/{{= request.application }}/splash/');

    

    var tabPanel = new Ext.TabPanel ({
        activeTab: 0,
<<<<<<< TREE
    layoutOnChange: true,
    region: 'center',
    items: [
        hs.app.blog,
        hs.app.map,
        hs.app.info,
        hs.app.find,
        hs.app.tool,
=======
	layoutOnChange: true,
	region: 'center',
	items: [
	    hs.app.blog,
	    hs.app.map,
	    hs.app.info,
	    hs.app.find,
	    hs.app.tool,
	    hs.app.case,
	    hs.app.tutorials,
	    hs.app.docs,
>>>>>>> MERGE-SOURCE
        ],
    });

    {{if side_bar:}}
    hs.app.user.analyses.setToolPanel (hs.app.tool, tabPanel, 4);
    hs.app.user.tools.setToolPanel (hs.app.tool, tabPanel, 4);    
    {{pass}}
    {{ if dev_tools: }}
    hs.app.user.dev.setToolPanel (hs.app.tool, tabPanel, 4);
    //devtools.setToolSide (tool_list);
    //tool_list.setDevSide (devtools);
    {{pass}}

    win = new Ext.Viewport ({
        title: 'skapes v0.4',
        //layoutOnChange: true,
        //collapsible: false,
        //maximizable: true,
        //maximized:   true,
        titleCollapse: true,
        layout: 'border',
        id: 'main_window',
        items:  [
        {
        title: 'Skapes v0.4',
        height: 'autoHeight',
        region: 'north',
        border: false,
        },
        hs.side,
            tabPanel, 
        ],
    });
    //win.show ();
    //win.toBack();
    //win.tools.close.hide();
    //win.tools.restore.hide();

    searchFindTab = function (term) {
    tabPanel.setActiveTab (3);
        findPanel.search (term);
    };

    //}, false);
    });
</script>
</head>
<body>
</body>
</html>
